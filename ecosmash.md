# EcoSmash Developer Notes

EcoSmash is an online Automotive Repairer environmental auditing tool.

## Export Files

* EcoSmash_20160411.sql
 > Mysql export of database including CMS pages and media as well as multiple tables for Self-Assessment Members (Repairers and Auditors), Assessments, Questions and Answers.
* ecosmash.com.au
 > HTML export of public website content.
* plugins/Assessment.php
 > PHP classess providing functionality for managing Self-Assessment Members (Repairers and Auditors), Assessments, Questions and Answers. Built for integration with Wisdom's PegasusCMS.
* plugins/Assessments
 > Administration tools for managing Self-Assessment Members (Repairers and Auditors), Assessments, Questions and Answers. Built for integration with Wisdom's PegasusCMS.
* readme.md
 > You are here.
* template
 > CMS Templates in PHP, CSS and JavaScript with images, fonts, etc.  
 > Self-Assessment templates in `_dashboard.php` and `_self-assessment.php`.
* uploads/1 .. 35
 > CMS file uploads, folders associated with database `pages`.`id` column.
* uploads/Assessments
 > Self-Assessment attachments. Files linked from `es_answers`.`evidence` column (in JSON format).

## Custom Functionality - Self Assessment Audit Tool

This functionality is coded in the *Assessment* plugin and is deeply integrated with the following templates:
1. _dashboard.php
2. _select-your-auditor.php
3. _self-assessment.php

Questions can be edited by Admin, but revisions to questions are not saved.

The Workflow for an Audit is as follows

1. Repairer registers on the website

 * The Repairer must enter all information, ABN must be valid (checked with algorithm) and unique
 * Email address must be unique
 * Password is generated by randomly selecting two words from a list

2. Repairer can commence a Self-Assessment from the Dashboard
 * A Self-Assessment consists of multiple questions grouped into Sections (1-10)
 * Questions must be answered "Yes", "No", "Unsure" or "N/A" if available
 * Repairer must supply *Evidence*, either a comment or file upload for each question
 * When all *Essential* questions are *Yes* or *N/A* the Assessment can be submitted for Essential Audit
 * If *Platinum Score* (80% of *weighted* *Platinum* questions are marked *Yes*) the Assessment can be submitted for Platinum Audit
 * On the End page of the Assessment, the PDF Report is generated, even if the Assessment has not been compelted

3. Repairer submits for Audit
 * Either *Essential Audit* or *Platinum Audit*
 * Select an *Auditor* (from the **es_members** database table)

4. Repairer Audits Assessment
 * Determine whether answers and evidence are passed or require more work/evidence
 * Must supply an audit action if more work/evidence required
 * After all complete submit Audit

5. If Audit Fails, Repairer revises Assessment
 * Failed questions highlighted in Red
 * After reviewing all failed questions, Re-submit for Audit (Step 3)

6. Repairer Submits Successfully Audited Assessment for Approval

7. Admin Approves Assessment
 * In Assessment Administration Tool, press "Approve"
 * Repairer is now *Approved*

## Toolbox

In `_toolbox.php` template, the Page Media is sorted and categoriesed to display as a media library.
Visitors must be logged in members, and can *star* an item to add it to their favourites which are viewed in `_favourites.php` template.
